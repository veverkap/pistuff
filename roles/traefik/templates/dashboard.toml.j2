# Adding in router for traefikdash
[http.routers.traefikdash]
  rule = "Host(`traefik.veverka.net`)"
  service = "api@internal"
  middlewares = ["auth"]

  [http.routers.traefikdash.tls]
    certResolver = "le" # From static configuration
    [[http.routers.traefikdash.tls.domains]]
      main = "traefik.veverka.net"

# Adding in router for consuldash
[http.services]
  [http.services.service-consul]
    [http.services.service-consul.loadBalancer]
      [[http.services.service-consul.loadBalancer.servers]]
        url = "http://192.168.1.124:8500"
      [[http.services.service-consul.loadBalancer.servers]]
        url = "http://192.168.1.137:8500"
      [[http.services.service-consul.loadBalancer.servers]]
        url = "http://192.168.1.149:8500"


[http.routers.consuldash]
  rule = "Host(`consul.veverka.net`)"
  service = "service-consul"
  middlewares = ["auth"]

  [http.routers.consuldash.tls]
    certResolver = "le" # From static configuration
    [[http.routers.consuldash.tls.domains]]
      main = "consul.veverka.net"

[tcp.services]
  [tcp.services.redis.loadBalancer]
    [[tcp.services.redis.loadBalancer.servers]]
      address = "192.168.1.151:20182"

[tcp.routers]
  [tcp.routers.redis]
    entryPoints = ["redis"]
    rule = "HostSNI(`*`)"
    service = "redis"

{% for item in traefix_dashboard_items %}
# Adding in router for {{item.name}}
[http.routers.{{ item.name }}]
  rule = "Host(`{{ item.host }}`)"
  service = "{{ item.service }}"
{% if item.include_auth | bool == True %}
  middlewares = ["auth"]
{% endif %}

  [http.routers.{{ item.name }}.tls]
    certResolver = "le" # From static configuration
    [[http.routers.{{ item.name }}.tls.domains]]
      main = "{{ item.host }}"

{% endfor %}

[http.middlewares.auth.basicAuth]
  usersFile = "/etc/traefik.d/users"
