#!/usr/bin/env ansible-playbook -i inventory
---
- hosts: all
  gather_facts: true
  remote_user: pi
  become: yes
  become_user: root
  roles:
    # - utils
    - { role: dnsmasq, consul_dns_domain: consul }
  tags:
    - bootstrap
# - name: setup the consul servers
#   hosts: consul_servers
#   become: true
#   become_user: root
#   gather_facts: true
#   remote_user: pi
#   roles:
#     - { role: consul, consul_is_server: yes }
#   tags:
#     - consul
#     - consul-servers
# - name: setup the consul followers
#   hosts: consul_followers
#   become: true
#   become_user: root
#   gather_facts: true
#   remote_user: pi
#   roles:
#     - { role: consul, consul_is_server: no }
#   tags:
#     - consul
# - name: setup the nomad servers
#   hosts: nomad_servers
#   become: true
#   become_user: root
#   gather_facts: true
#   remote_user: pi
#   roles:
#     - { role: nomad, nomad_is_server: yes, nomad_dc: alpha }
#   tags:
#     - nomad
# - name: setup the nomad workers
#   hosts: nomad_workers
#   become: true
#   become_user: root
#   gather_facts: true
#   remote_user: pi
#   roles:
#     - { role: nomad, nomad_dc: alpha }
#   tags:
#     - nomad
